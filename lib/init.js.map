{"version":3,"sources":["../src/init.ts"],"names":["initState","Promise","resolve","inited","init","item","then","_","catch","uninitHandle","e","undefined"],"mappings":"AAAA;AACA,IAAIA,SAAS,GAAGC,OAAO,CAACC,OAAR,EAAhB;AACA;;AACA,IAAIC,MAAM,GAAG,KAAb;AAEA;;AAMA;AACA,SAASC,IAAT,CAAcC,IAAd,EAAgG;AAC/F,MAAIA,IAAI,KAAK,IAAb,EAAmB;AAAE,WAAOL,SAAS,CAACM,IAAV,CAAqB,MAAMH,MAAM,GAAG,IAApC,CAAP;AAAmD;;AACxE,MAAIE,IAAJ,EAAU;AACTL,IAAAA,SAAS,GAAGA,SAAS,CACnBM,IADU,CACLC,CAAC,IAAI,OAAOF,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,EAAjC,GAAsCA,IADtC,EAEVG,KAFU,CAEJ,MAAM,IAFF,CAAZ;AAGA,WAAOR,SAAS,CAACM,IAAV,CAAqB,MAAMH,MAAM,GAAG,IAApC,CAAP;AAAiD;AACjD;;AACD,MAAIA,MAAJ,EAAY;AAAE,WAAO,IAAP;AAAc;;AAC5B,MAAI,OAAOC,IAAI,CAACK,YAAZ,KAA6B,UAAjC,EAA6C;AAC5C,QAAI;AAAEL,MAAAA,IAAI,CAACK,YAAL;AAAsB,KAA5B,CAA6B,OAAMC,CAAN,EAAQ,CAAE;AACvC;;AACD,SAAO,KAAP;AACA;;AACDN,IAAI,CAACK,YAAL,GAAoBE,SAApB;AAEA,eAAeP,IAAf","sourcesContent":["/** 初始化状态存储 */\r\nlet initState = Promise.resolve();\r\n/** 是否已初始化 */\r\nlet inited = false;\r\n\r\n/** 进行初始化，并返回是否可以继续执行 */\r\nfunction init(): boolean;\r\n/** 等待初始化完成 */\r\nfunction init(wait: true): Promise<true>;\r\n/** 添加初始函数 */\r\nfunction init(item: (() => Promise<any> | any) | Promise<any>): Promise<true>;\r\n/** 进行初始化，并返回是否可以继续执行 */\r\nfunction init(item?: true | (() => Promise<any> | any) | Promise<any>): boolean | Promise<true> {\r\n\tif (item === true) { return initState.then<true>(() => inited = true); }\r\n\tif (item) {\r\n\t\tinitState = initState\r\n\t\t\t.then(_ => typeof item === 'function' ? item() : item)\r\n\t\t\t.catch(() => true);\r\n\t\treturn initState.then<true>(() => inited = true);;\r\n\t}\r\n\tif (inited) { return true; }\r\n\tif (typeof init.uninitHandle === 'function') {\r\n\t\ttry { init.uninitHandle(); } catch(e){}\r\n\t}\r\n\treturn false;\r\n}\r\ninit.uninitHandle = undefined as undefined | (() => any);\r\n\r\nexport default init as {\r\n\t/** 进行初始化，并返回是否可以继续执行 */\r\n\t(): boolean;\r\n\t/** 等待初始化完成 */\r\n\t(wait: true): Promise<true>;\r\n\t/** 添加初始函数 */\r\n\t(item: (() => Promise<any> | any) | Promise<any>): Promise<true>;\r\n\t/** 未初始化时调用的方法 */\r\n\tuninitHandle: undefined | (() => any);\r\n};\r\n"],"file":"init.js"}